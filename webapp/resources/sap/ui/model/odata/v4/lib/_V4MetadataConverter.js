/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2017 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","./_Helper","./_MetadataConverter"],function(q,_,a){"use strict";var e="http://docs.oasis-open.org/odata/ns/edmx",V,A=a.oAnnotationConfig,o={"Reference":{"Include":{__processor:a.processAlias}},"DataServices":{"Schema":{__processor:a.processAlias}}},s={"Property":{__processor:D,__include:[A]},"NavigationProperty":{__processor:z,__include:[A],"OnDelete":{__processor:B,__include:[A]},"ReferentialConstraint":{__processor:C,__include:[A]}}},E={"NavigationPropertyBinding":{__processor:n}},b={"Parameter":{__processor:r,__include:[A]},"ReturnType":{__processor:t,__include:[A]}},f={__processor:d,__include:[a.oReferenceInclude],"DataServices":{"Schema":{__processor:a.processSchema,__include:[a.oAnnotationsConfig,A],"Action":{__processor:p,__include:[b,A]},"Function":{__processor:p,__include:[b,A]},"EntityType":{__processor:i,__include:[s,A],"Key":{"PropertyRef":{__processor:j}}},"ComplexType":{__processor:c,__include:[s,A]},"EntityContainer":{__processor:g,__include:[A],"ActionImport":{__processor:m.bind(null,"Action"),__include:[A]},"EntitySet":{__processor:h,__include:[E,A]},"FunctionImport":{__processor:m.bind(null,"Function"),__include:[A]},"Singleton":{__processor:u,__include:[E,A]}},"EnumType":{__processor:k,__include:[A],"Member":{__processor:l,__include:[A]}},"Term":{__processor:v,__include:[A]},"TypeDefinition":{__processor:y,__include:[A]}}}};function p(F,G){var K=F.localName,Q=G.namespace+F.getAttribute("Name"),H={$kind:K};V.processAttributes(F,H,{"IsBound":V.setIfTrue,"EntitySetPath":V.setValue,"IsComposable":V.setIfTrue});V.getOrCreateArray(G.result,Q).push(H);G.actionOrFunction=H;V.annotatable(G,H);}function c(F,G){w(F,G,{"$kind":"ComplexType"});}function d(F,G){V.processAttributes(F,G.result,{"Version":V.setValue});}function g(F,G){var Q=G.namespace+F.getAttribute("Name");G.result[Q]=G.entityContainer={"$kind":"EntityContainer"};G.result.$EntityContainer=Q;V.annotatable(G,Q);}function h(F,G){var N=F.getAttribute("Name");G.entityContainer[N]=G.entitySet={$kind:"EntitySet",$Type:V.resolveAlias(F.getAttribute("EntityType"),G)};V.processAttributes(F,G.entitySet,{"IncludeInServiceDocument":V.setIfFalse});V.annotatable(G,N);}function i(F,G){w(F,G,{$kind:"EntityType"});}function j(F,G){var H=F.getAttribute("Alias"),K,N=F.getAttribute("Name");if(H){K={};K[H]=N;}else{K=N;}V.getOrCreateArray(G.type,"$Key").push(K);}function k(F,G){var Q=G.namespace+F.getAttribute("Name"),H={"$kind":"EnumType"};V.processAttributes(F,H,{"IsFlags":V.setIfTrue,"UnderlyingType":function(I){return I!=="Edm.Int32"?I:undefined;}});G.result[Q]=G.enumType=H;G.enumTypeMemberCounter=0;V.annotatable(G,Q);}function l(F,G){var N=F.getAttribute("Name"),H=F.getAttribute("Value"),I;if(H){I=parseInt(H,10);if(!_.isSafeInteger(I)){I=H;}}else{I=G.enumTypeMemberCounter;G.enumTypeMemberCounter++;}G.enumType[N]=I;V.annotatable(G,N);}function m(W,F,G){var I={$kind:W+"Import"},N=F.getAttribute("Name");I["$"+W]=V.resolveAlias(F.getAttribute(W),G);V.processAttributes(F,I,{"EntitySet":function(H){return V.resolveTargetPath(H,G);},"IncludeInServiceDocument":V.setIfTrue});G.entityContainer[N]=I;V.annotatable(G,N);}function n(F,G){var N=V.getOrCreateObject(G.entitySet,"$NavigationPropertyBinding");N[F.getAttribute("Path")]=V.resolveTargetPath(F.getAttribute("Target"),G);}function r(F,G){var H=G.actionOrFunction,P={};x(F.getAttribute("Type"),P,G);V.processAttributes(F,P,{"Name":V.setValue,"Nullable":V.setIfFalse});V.processFacetAttributes(F,P);V.getOrCreateArray(H,"$Parameter").push(P);V.annotatable(G,P);}function t(F,G){var H=G.actionOrFunction,R={};x(F.getAttribute("Type"),R,G);V.processAttributes(F,R,{"Nullable":V.setIfFalse});V.processFacetAttributes(F,R);H.$ReturnType=R;V.annotatable(G,R);}function u(F,G){var N=F.getAttribute("Name");G.entityContainer[N]=G.entitySet={$kind:"Singleton",$Type:V.resolveAlias(F.getAttribute("Type"),G)};V.annotatable(G,N);}function v(F,G){var Q=G.namespace+F.getAttribute("Name"),T={$kind:"Term"};x(F.getAttribute("Type"),T,G);V.processAttributes(F,T,{"Nullable":V.setIfFalse,"BaseTerm":function(H){return H?V.resolveAlias(H,G):undefined;}});V.processFacetAttributes(F,T);G.result[Q]=T;V.annotatable(G,Q);}function w(F,G,T){var Q=G.namespace+F.getAttribute("Name");V.processAttributes(F,T,{"OpenType":V.setIfTrue,"HasStream":V.setIfTrue,"Abstract":V.setIfTrue,"BaseType":function(H){return H?V.resolveAlias(H,G):undefined;}});G.result[Q]=G.type=T;V.annotatable(G,Q);}function x(T,P,F){var M=V.rCollection.exec(T);if(M){P.$isCollection=true;T=M[1];}P.$Type=V.resolveAlias(T,F);}function y(F,G){var Q=G.namespace+F.getAttribute("Name"),T={"$kind":"TypeDefinition","$UnderlyingType":F.getAttribute("UnderlyingType")};G.result[Q]=T;V.processFacetAttributes(F,T);V.annotatable(G,Q);}function z(F,G){var N=F.getAttribute("Name"),P={$kind:"NavigationProperty"};x(F.getAttribute("Type"),P,G);V.processAttributes(F,P,{"Nullable":V.setIfFalse,"Partner":V.setValue,"ContainsTarget":V.setIfTrue});G.type[N]=G.navigationProperty=P;V.annotatable(G,N);}function B(F,G){G.navigationProperty.$OnDelete=F.getAttribute("Action");V.annotatable(G,G.navigationProperty,"$OnDelete");}function C(F,G){var P=F.getAttribute("Property"),R=V.getOrCreateObject(G.navigationProperty,"$ReferentialConstraint");R[P]=F.getAttribute("ReferencedProperty");V.annotatable(G,R,P);}function D(F,G){var N=F.getAttribute("Name"),P={"$kind":"Property"};x(F.getAttribute("Type"),P,G);V.processAttributes(F,P,{"Nullable":V.setIfFalse,"DefaultValue":V.setValue});V.processFacetAttributes(F,P);G.type[N]=P;V.annotatable(G,N);}V=q.extend({},a,{convertXMLMetadata:function(F,U){var G,H;q.sap.measure.average("convertXMLMetadata","","sap.ui.model.odata.v4.lib._V4MetadataConverter");H=F.documentElement;if(H.localName!=="Edmx"||H.namespaceURI!==e){throw new Error(U+" is not a valid OData V4 metadata document");}G={"actionOrFunction":null,"aliases":{},"annotatable":null,"entityContainer":null,"entitySet":null,"enumType":null,"enumTypeMemberCounter":0,"namespace":null,"navigationProperty":null,"processFacetAttributes":V.processFacetAttributes,"processTypedCollection":x,"reference":null,"schema":null,"type":null,"result":{}};V.traverse(H,G,o);V.traverse(H,G,f);if(G.result.$Version!=="4.0"){throw new Error(U+": Unsupported OData version "+G.result.$Version);}q.sap.measure.end("convertXMLMetadata");return G.result;},processFacetAttributes:function(F,R){V.processAttributes(F,R,{"MaxLength":function(G){return G==="max"?undefined:V.setNumber(G);},"Precision":V.setNumber,"Scale":function(G){return G==="variable"?G:V.setNumber(G);},"SRID":V.setValue,"Unicode":V.setIfFalse});}});return V;},false);
