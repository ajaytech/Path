/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2017 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/test/_OpaLogger","sap/ui/test/_ParameterValidator","sap/ui/test/autowaiter/_utils"],function($,_,a,b){"use strict";var l=_.getLogger("sap.ui.test.autowaiter._timeoutWaiter");var h=_.getLogger("sap.ui.test.autowaiter._timeoutWaiter#hasPending");var c=new a({errorPrefix:"sap.ui.test.autowaiter._timeoutWaiter#extendConfig"});var t={};var d={maxDepth:3,maxDelay:1000};var C=0;function e(n){var s="set"+n;var i="clear"+n;var o=window[s];if(!o){return;}var O=window[i];window[s]=function(j,D){var w=function(){C=(t[I]?t[I].depth:0)+1;delete t[I];try{j();l.trace("Timeout with ID "+I+" finished");}finally{C=0;}};var I;var p={depth:C,delay:D,func:b.functionToString(j),stack:b.resolveStackTrace()};if(D>=d.maxDelay){I=o.apply(this,arguments);l.trace("Timeout delay "+D+" reached the limit of "+d.maxDelay+". Long-running timeout is ignored:"+f(I,p));}else{I=o.call(this,w,D);l.trace("Timeout with ID "+I+" scheduled. Delay: "+D+" Depth: "+C);t[I]=p;if(C>=d.maxDepth){l.trace("Timeout depth reached the limit of "+d.maxDepth+". Non-blocking timeout is ignored:"+f(I,t[I]));t[I].nonBlocking=true;}}return I;};window[i]=function(I){delete t[I];l.trace("Timeout with ID "+I+" cleared");return O.apply(this,arguments);};}e("Timeout");e("Immediate");function f(T,m){return"\nTimeout: ID: "+T+" Delay: "+m.delay+" Depth: "+m.depth+" Function: "+m.func+" Stack: "+m.stack;}function g(B){var L="There are "+B.length+" open blocking timeouts";B.forEach(function(T){L+=f(T,t[T]);});h.debug(L);}return{hasPending:function(){var B=Object.keys(t).filter(function(i){return!t[i].nonBlocking;});var H=B.length>0;if(H){g(B);}return H;},extendConfig:function(o){c.validate({inputToValidate:o,validationInfo:{maxDepth:"numeric",maxDelay:"numeric"}});$.extend(d,o);}};},true);
